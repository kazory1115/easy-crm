# 報價單系統專案架構文件

## 📋 專案概述

這是一個基於 **Vue 3 + Vite + Tailwind CSS** 的現代化報價單管理系統，主要用於設備報價單的建立、編輯與匯出。

### 技術棧

- **前端框架**: Vue 3.5.13 (Composition API)
- **建置工具**: Vite 6.3.5
- **路由管理**: Vue Router 4.5.1
- **UI 框架**: Tailwind CSS
- **資料儲存**: LocalStorage (v2.0 新增)

---

## ✨ 架構升級 (v2.0) - 自定義模板系統

專案近期進行了一次重大的架構升級，將原本固定的「主機項目」功能，重構為一個高度靈活的「自定義項目模板」系統。

### 核心變更

- **從靜態到動態**：使用者不再受限於固定的欄位（如主吊馬力、吊速），而是可以為不同類型的設備（如主機、防火牆、伺服器）建立完全自訂的規格模板。
- **提升擴充性**：此變更讓系統能適應更多樣化的報價需求，無需修改程式碼即可新增不同產品的規格範本。

### 1. 資料結構演進

舊有的 `hosts.json` 被新的 `templates.json` 取代，其結構從固定屬性變為彈性的 `fields` 陣列。

**舊結構 (`hosts.json`)**

```json
{
  "id": 1,
  "name": "主機規格 A",
  "cpu": "Intel Xeon",
  "ram": "32GB"
}
```

**新結構 (`templates.json`)**

```json
{
  "id": "tpl-001",
  "name": "網站主機",
  "fields": [
    { "id": "field-01", "label": "CPU 核心數", "value": "8 Cores" },
    { "id": "field-02", "label": "記憶體", "value": "16GB DDR4" }
  ]
}
```

### 2. 資料管理層 (`dataManager.js`)

對 `src/utils/dataManager.js` 進行了全面重構，以支援新的模板系統。

- **函式更名**：所有 `host` 相關的函式 (e.g., `getHosts`, `addHost`) 已被替換為 `template` 相關函式 (e.g., `getTemplates`, `addTemplate`)。
- **ID 機制的改變**：新增模板時，使用 `crypto.randomUUID()` 生成唯一的字串 ID，以確保資料的穩定性。

### 3. 模板管理介面 (`Add.vue`)

「項目管理」頁面進行了徹底改造，提供了一個強大的所見即所得 (WYSIWYG) 模板編輯器。

- **兩欄式佈局**：左側為模板列表，右側為編輯區。
- **動態欄位編輯**：使用者可以為模板動態新增、命名、修改及刪除任意數量的欄位。
- **即時操作**：所有變更都會透過 `dataManager` 即時儲存到 LocalStorage。

### 4. 報價單整合 (`Home.vue`)

報價單主頁面已完全整合新的模板系統。

- **項目類型更新**：使用者現在可以從「新增項目」下拉選單中選擇「自定義模板」。
- **動態呈現**：當使用者選擇一個模板後，該模板的名稱及其所有自定義欄位都會被動態載入並清晰地顯示在報價單的項目列中。

---

## 📁 目錄結構

```
quote_project/
├── src/
│   ├── assets/              # 靜態資源
│   ├── components/          # 可重用元件
│   ├── data/                # 預設資料 (JSON)
│   │   ├── items.json
│   │   ├── templates.json   # (v2.0 新增)
│   │   └── quotes.json
│   ├── layouts/             # 版面配置元件
│   ├── router/              # 路由配置
│   ├── utils/               # 工具函式
│   │   └── dataManager.js   # (v2.0 核心)
│   ├── views/               # 頁面視圖
│   │   ├── Home.vue
│   │   ├── Add.vue
│   │   └── History.vue
│   ├── App.vue
│   └── main.js
...
```

---

## 📱 頁面視圖

### 1. `views/Home.vue` - 報價單主頁 ⭐ (核心頁面)

**主要功能**：

1. **報價單基本資訊輸入**
2. **動態項目管理**
   - 新增項目 (三種類型)
     - 一般項目 (從範本選擇)
     - **自定義模板項目** (v2.0) (從自訂模板選擇)
     - 手動填寫項目
   - 刪除項目
   - 即時複價計算
3. **金額計算與匯出**

### 2. `views/Add.vue` - 項目與模板管理頁面

**主要功能**：

- **分頁管理**：透過頁籤切換「一般項目」與「自定義模板」的管理介面。
- **一般項目管理**：提供對基本項目的 CRUD 功能。
- **自定義模板管理 (v2.0)**：提供對模板及其動態欄位的完整 CRUD 功能。

---

## 💾 資料管理 (v2.0)

### 目前狀態

- ✅ **瀏覽器端持久化**：所有資料 (報價單、項目、模板) 皆使用 **LocalStorage** 進行儲存。
- ✅ **統一資料接口**：所有 LocalStorage 的讀寫操作都集中在 `src/utils/dataManager.js` 模組中，使其成為應用程式的偽後端 (pseudo-backend)。
- ✅ **啟動時初始化**：應用程式啟動時 (`main.js`) 會檢查 LocalStorage。如果為空，則會從 `src/data/*.json` 載入預設資料，避免使用者初次使用時看到空白頁面。

### 資料流

```
src/data/*.json (預設資料)
      ↓ (僅在首次啟動時)
LocalStorage (主要資料來源)
      ↕ (透過 dataManager.js)
Vue Components (UI)
```

---

## 🎯 專案特色

1. ✨ **專業報價單系統** - 針對主機設備報價設計
2. 🔧 **高度擴充性 (v2.0)** - 支援完全自定義的項目模板
3. 🎨 **現代化 UI** - Tailwind CSS 打造美觀界面
4. 📱 **響應式設計** - 完整支援桌面與手機版
5. 📄 **實用功能** - 列印、匯出 Word、儲存歷史紀錄

---

## 📝 版本資訊

**Vue**: 3.5.13  
**Vite**: 6.3.5  
**Vue Router**: 4.5.1
**專案類型**: 單頁應用程式 (SPA)

---

_最後更新: 2025-11-06_
_維護者: kazlab_
